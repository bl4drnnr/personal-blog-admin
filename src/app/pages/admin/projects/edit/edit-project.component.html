<layout-default>
  <div class="admin-page-container" *ngIf="project">
    <div class="page-header">
      <div class="header-content">
        <div class="header-left">
          <basic-button
            label="← Back to Projects"
            [onWhite]="true"
            (buttonClick)="cancel()"
          />
          <div class="page-title-section">
            <h1>Edit Project</h1>
            <div class="status-badges">
              <span class="status-badge" [class.published]="published" [class.draft]="!published">
                {{ published ? 'Published' : 'Draft' }}
              </span>
              <span class="status-badge featured" *ngIf="featured">
                Featured
              </span>
            </div>
          </div>
        </div>
        <div class="header-actions" *ngIf="project">
          <div class="quick-actions">
            <basic-button
              *ngIf="!published"
              label="Publish"
              [fillButton]="true"
              [onWhite]="false"
              (buttonClick)="changePublishStatus()"
            />
            <basic-button
              *ngIf="published"
              label="Unpublish"
              [onWhite]="true"
              (buttonClick)="changePublishStatus()"
            />
            <basic-button
              [label]="featured ? 'Unfeature' : 'Feature'"
              [fillButton]="!featured"
              [onWhite]="featured"
              (buttonClick)="toggleFeatured()"
            />
            <basic-button
              label="Save Changes"
              [fillButton]="true"
              [onWhite]="false"
              (buttonClick)="saveProject()"
            />
          </div>
          <div class="danger-actions">
            <basic-button
              label="Delete"
              [onWhite]="true"
              [danger]="true"
              (buttonClick)="deleteProject()"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Project Status Overview -->
    <div class="status-overview-section" *ngIf="project">
      <div class="status-card">
        <div class="status-info">
          <div class="status-item">
            <label>Status:</label>
            <span class="status-value" [class.published]="published" [class.draft]="!published">
              {{ published ? 'Published' : 'Draft' }}
            </span>
          </div>
          <div class="status-item">
            <label>Featured:</label>
            <span class="status-value" [class.active]="featured">
              {{ featured ? 'Yes' : 'No' }}
            </span>
          </div>
          <div class="status-item">
            <label>Slug:</label>
            <span class="status-value slug">{{ project.projectSlug }}</span>
          </div>
        </div>
        <div class="date-info">
          <div class="date-item">
            <label>Created:</label>
            <span>{{ project.createdAt | date:'medium' }}</span>
          </div>
          <div class="date-item">
            <label>Last Updated:</label>
            <span>{{ project.updatedAt | date:'medium' }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Form -->
    <div *ngIf="project" class="content-section">
      <!-- Basic Information -->
      <div class="card">
        <div class="card-header">
          <h2>Basic Information</h2>
        </div>
        <div class="form-section">
          <div class="form-row">
            <div class="form-group full-width">
              <basic-input
                type="text"
                label="Project Name"
                placeholder="Enter project name"
                [value]="projectName"
                (valueChange)="projectName = $event"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group full-width">
              <basic-textarea
                label="Description"
                placeholder="Enter project description"
                [value]="description"
                (valueChange)="description = $event"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group full-width">
              <basic-input
                label="Meta Keywords"
                placeholder="Enter SEO keywords separated by commas (e.g., react, node.js, full-stack)"
                [value]="metaKeywords"
                (valueChange)="metaKeywords = $event"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group full-width">
              <basic-input
                label="Project Type"
                placeholder="Enter project type (e.g., Web Application, Mobile App, API, etc.)"
                [value]="projectType"
                (valueChange)="projectType = $event"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group full-width">
              <asset-selector
                label="Project Image"
                placeholder="Search for project image..."
                [(ngModel)]="projectImageId"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Content -->
      <div class="card">
        <div class="card-header">
          <h2>Content</h2>
        </div>
        <div class="form-section">
          <div class="form-row">
            <div class="form-group full-width">
              <basic-html-editor
                label="Project Content"
                [value]="content"
                (valueChange)="content = $event"
                (processedContentForSave)="processedContent = $event"
                [showPreview]="true"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Tags & Status Settings -->
      <div class="card">
        <div class="card-header">
          <h2>Tags Settings</h2>
        </div>
        <div class="form-section">
          <!-- Tags Section -->
          <div class="tags-input-container">
            <h4>Tags</h4>
            <div class="current-tags" *ngIf="tags.length > 0">
              <span *ngFor="let tag of tags; let i = index" class="tag">
                {{ tag }}
                <button type="button" class="tag-remove" (click)="removeTag(i)">×</button>
              </span>
            </div>
            <div class="add-tag-input">
              <basic-input
                type="text"
                label="Add Tag"
                placeholder="Enter tag and press Enter"
                [value]="tagInput"
                (valueChange)="tagInput = $event"
                (keyup)="onTagInputKeyPress($event)"
              />
            </div>
            <basic-button
              label="Add Tag"
              [onWhite]="true"
              (buttonClick)="addTag()"
              [disabled]="!tagInput.trim()"
            />
          </div>
        </div>
      </div>

      <!-- Final Actions -->
      <div class="final-actions">
        <basic-button
          label="Save Changes"
          [fillButton]="true"
          [onWhite]="false"
          (buttonClick)="saveProject()"
        />
        <basic-button
          label="Cancel"
          [onWhite]="true"
          (buttonClick)="cancel()"
        />
      </div>
    </div>
  </div>
</layout-default>
