<layout-default>
  <div class="admin-page-container">
    <div class="page-header">
      <h1>Password Protection Mode</h1>
      <p>Temporarily protect the site with a password for debugging purposes</p>
    </div>

    <div class="content-section" *ngIf="!loading">

      <!-- Current Status Card -->
      <div class="card status-card">
        <div class="status-header">
          <h2>Current Status</h2>
          <div class="status-indicator">
            <span class="status-dot" [class.active]="isActive" [class.inactive]="!isActive"></span>
            <span class="status-text">{{ isActive ? 'ACTIVE' : 'INACTIVE' }}</span>
          </div>
        </div>

        <div class="status-info" *ngIf="passwordProtectionMode">
          <div class="info-row">
            <strong>Duration:</strong>
            <span>{{ passwordProtectionMode.durationHours }} hours</span>
          </div>
          <div class="info-row">
            <strong>Hero Title:</strong>
            <span>{{ passwordProtectionMode.heroTitle }}</span>
          </div>
          <div class="info-row">
            <strong>Meta Title:</strong>
            <span>{{ passwordProtectionMode.metaTitle }}</span>
          </div>
          <div class="info-row">
            <strong>Footer Text:</strong>
            <span>{{ passwordProtectionMode.footerText }}</span>
          </div>
        </div>

        <!-- Quick Toggle -->
        <div class="quick-actions">
          <basic-button
            [label]="isActive ? 'Deactivate Password Protection' : 'Activate Password Protection'"
            [disabled]="isFormDisabled()"
            (click)="onTogglePasswordProtection()">
          </basic-button>
        </div>
      </div>

      <!-- Configuration Settings -->
      <div class="card">
        <h2>Password Protection Settings</h2>

        <div class="password-protection-settings">

          <!-- Activation Toggle -->
          <div class="form-row">
            <label class="checkbox-label">
              <input
                type="checkbox"
                [(ngModel)]="isActive"
                [disabled]="isFormDisabled()">
              <span class="checkbox-text">Enable Password Protection Mode</span>
            </label>
          </div>

          <!-- Password -->
          <div class="form-row">
            <div class="password-input-container">
              <basic-input
                label="Protection Password"
                [type]="showPassword ? 'text' : 'password'"
                placeholder="Enter password for site access"
                [(value)]="password"
                [disabled]="isFormDisabled()"
                [showError]="passwordError"
                [errorMessage]="passwordErrorMessage"
                [minLength]="6"
                [maxLength]="50"
                (valueChange)="onPasswordChange($event)"
                (incorrectInput)="onPasswordError($event)">
              </basic-input>
              <button
                type="button"
                class="password-toggle"
                (click)="togglePasswordVisibility()"
                [disabled]="isFormDisabled()">
                {{ showPassword ? 'üëÅÔ∏è' : 'üôà' }}
              </button>
            </div>
          </div>

          <!-- Duration -->
          <div class="form-row">
            <label class="form-label">Access Duration (hours)</label>
            <div class="duration-selector">
              <div class="duration-options">
                <label *ngFor="let option of durationOptions" class="duration-option">
                  <input
                    type="radio"
                    name="duration"
                    [value]="option.value"
                    [(ngModel)]="durationHours"
                    [disabled]="isFormDisabled()">
                  <span>{{ option.label }}</span>
                </label>
              </div>
              <div class="custom-duration" *ngIf="durationHours === -1">
                <basic-input
                  label="Custom Duration (hours)"
                  type="number"
                  placeholder="Enter custom hours"
                  [value]="customDurationString"
                  [disabled]="isFormDisabled()"
                  [min]="'1'"
                  [max]="'168'"
                  (valueChange)="onCustomDurationChange($event)">
                </basic-input>
              </div>
            </div>
          </div>

          <!-- Hero Image -->
          <div class="form-row">
            <asset-selector
              label="Hero Image"
              [(ngModel)]="heroImageId">
            </asset-selector>
          </div>

          <!-- Hero Title -->
          <div class="form-row">
            <basic-input
              label="Hero Title"
              placeholder="Enter the hero section title"
              [(value)]="heroTitle"
              [disabled]="isFormDisabled()"
              (valueChange)="onHeroTitleChange($event)">
            </basic-input>
          </div>

          <!-- Meta Title -->
          <div class="form-row">
            <basic-input
              label="Meta Title (Browser Tab)"
              placeholder="Enter the page title shown in browser tab"
              [(value)]="metaTitle"
              [disabled]="isFormDisabled()"
              (valueChange)="onMetaTitleChange($event)">
            </basic-input>
          </div>

          <!-- Footer Text -->
          <div class="form-row">
            <basic-textarea
              label="Footer Text"
              placeholder="Enter the footer text"
              [(value)]="footerText"
              [disabled]="isFormDisabled()"
              [minLength]="1"
              [maxLength]="200"
              (valueChange)="onFooterTextChange($event)">
            </basic-textarea>
          </div>

          <!-- Info Note -->
          <div class="info-note">
            <p><strong>Note:</strong> Password protection mode is designed for temporary debugging access.
            Only logged-in administrators can obtain access tokens. The protection will remain active
            until you manually deactivate it.</p>
          </div>

          <!-- Submit Button -->
          <div class="form-actions">
            <basic-button
              label="Save Settings"
              type="primary"
              [disabled]="isFormDisabled() || !isFormValid()"
              (click)="onSubmit()">
            </basic-button>
          </div>
        </div>
      </div>

    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
      <div class="loading-spinner">
        <p>Loading password protection settings...</p>
      </div>
    </div>

  </div>
</layout-default>
